import math
# import matplotlib
# import matplotlib.pyplot as plt
# import numpy as np

def logKf(Reactant, T):

    if Reactant == "Fe3C":
        logKf = math.log10((math.e) ** ((-29040 / (8.3145 * T)) + 28.03 / 8.3145))
        # logKf = math.log10((math.e) ** ((-2.2083-24.5426*(10**(-3))*T*math.log(T)+17.7656*(10**(-6))*(T**2)+356.673*(T**(-1))+153.89*(10**(-3)))/(-8.314*T)))
        return logKf

    if Reactant == "Fe5C2":
        logKf_table = {
            573: -66.851,
            673: -54.336,
            773: -45.392,
            873: -38.681,
            973: -33.461,
            1073: -29.286,
            1173: -25.869,
            1273: -23.023,
            1373: -20.615,
            1473: -18.552,
            1573: -16.765,
        }
    if Reactant in ["O2" , "C" , "Fe" , "H2"]:
        logKf_table = {
            298.15: 0,
            300: 0,
            400: 0,
            500: 0,
            600: 0,
            700: 0,
            800: 0,
            900: 0,
            1000:0,
            1100:0,
            1200:0,
            1300:0,
            1400:0,
            1500:0,
        }
    elif Reactant == "C(g)":
        logKf_table = {
            298.15: -117.599,
            300: -116.825,
            350: -98.991,
            400: -85.606,
            450: -75.189,
            500: -66.851,
            600: -54.336,
            700: -45.392,
            800: -38.681,
            900: -33.461,
            1000: -29.286,
            1100: -25.869,
            1200: -23.023,
            1300: -20.615,
            1400: -18.552,
            1500: -16.765,
        }
    elif Reactant == "CO":
        logKf_table = {
            298.15: 24.03,
            300: 23.911,
            400: 19.110,
            500: 16.236,
            600: 14.320,
            700: 12.948,
            800: 11.916,
            900: 11.109,
            1000:10.461,
            1100:9.928,
            1200:9.481,
            1300:9.101,
            1400:8.774,
            1500:8.488,
        }
    # elif Reactant == "C":
    #     logKf_table = {
    #         298.15: 0,
    #         300: 0,
    #         400: 0,
    #         500: 0,
    #         600: 0,
    #         700: 0,
    #         800: 0,
    #         900: 0,
    #         1000:0,
    #         1100:0,
    #         1200:0,
    #         1300:0,
    #         1400:0,
    #         1500:0,
    #     }

    elif Reactant == "CO2":
        logKf_table = {
            298.15: 69.095,
            300: 68.670,
            400: 51.539,
            500: 41.259,
            600: 34.404,
            700: 29.505,
            800: 25.829,
            900: 22.969,
            1000:20.679,
            1100:18.805,
            1200:17.242,
            1300:15.919,
            1400:14.784,
            1500:13.800,
        }

    elif Reactant == "H2O":
        logKf_table = {
            298.15: 40.047,
            300: 39.785,
            400: 29.238,
            500: 22.884,
            600: 18.631,
            700: 15.582,
            800: 13.287,
            900: 11.496,
            1000: 10.06,
            1100: 8.881,
            1200: 7.897,
            1300: 7.063,
            1400: 6.346,
            1500: 5.724,
        }

    elif Reactant == "CH4":
        logKf_table = {
            298.15: 8.894,
            300: 8.813,
            350: 6.932,
            400: 5.492,
            450: 4.35,
            500: 3.42,
            600: 1.993,
            700: 0.943,
            800: 0.138,
            900: -0.5,
            1000: -1.018,
            1100: -1.447,
            1200: -1.807,
            1300: -2.115,
            1400: -2.379,
            1500: -2.609,
        }

    elif Reactant == "Fe2O3":
        logKf_table = {
            298.15: 130.262,
            300: 129.370,
            400: 93.464,
            500: 71.972,
            600: 57.688,
            700: 47.521,
            800: 39.925,
            900: 34.040,
            1000:29.349,
            1100:25.508,
            1200:22.303,
            1300:19.590,
            1400:17.271,
            1500:15.265,
        }

    elif Reactant == "Fe3O4":
        logKf_table = {
            298.15: 178.251,
            300: 177.040,
            400: 128.286,
            500: 99.108,
            600: 79.727,
            700: 65.948,
            800: 55.673,
            900: 47.732,
            1000:41.401,
            1100:36.206,
            1200:31.869,
            1300:28.197,
            1400:25.057,
            1500:22.341,
        }

    elif Reactant == "Fe0.947O":
        logKf_table = {
            298.15: 42.948,
            300: 42.66,
            400: 31.09,
            500: 24.172,
            600: 19.575,
            700: 16.299,
            800: 13.847,
            900: 11.941,
            1000: 10.415,
            1100: 9.161,
            1200: 8.113,
            1300: 7.226,
            1400: 6.468,
            1500: 5.813,
        }

    elif Reactant == "FeO":
        logKf_table = {
            298.15: 44.049,
            300: 43.755,
            400: 31.934,
            500: 24.866,
            600: 20.168,
            700: 16.821,
            800: 14.316,
            900: 12.369,
            1000: 10.81,
            1100: 9.529,
            1200: 8.458,
            1300: 7.552,
            1400: 6.777,
            1500: 6.108,
        }
    if T in logKf_table:
        logKf = logKf_table[T]

    else:
        lower_known_temperature = None
        for temperature in sorted(logKf_table.keys()):
            if temperature <= T:
                lower_known_temperature = temperature
            else:
                break

        upper_known_temperature = None
        for temperature in sorted(logKf_table.keys()):
            if temperature > T:
                upper_known_temperature = temperature
                break

        if lower_known_temperature is not None and upper_known_temperature is not None:
            R = (T-lower_known_temperature) / (upper_known_temperature - T)

            logKf = (logKf_table[upper_known_temperature] * R + logKf_table[lower_known_temperature]) / (1+R)

        else:
            print(f"给定温度 {T} 不在本程序设定范围")

    return logKf